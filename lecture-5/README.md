# Лекція 5: Інфраструктура та Балансування Навантаження

У цій папці містяться UML діаграми, що демонструють архітектуру глобальної інфраструктури, стратегії балансування навантаження та забезпечення високої доступності в розподілених системах.

## Діаграми

### 1. Global Infrastructure Architecture (infrastructure.puml)
**Глобальна архітектура з регіональними дата-центрами**

Комплексна інфраструктура для глобального сервісу освіти:
- **Anycast DNS + GTM** - глобальне маршрутизація трафіку
- **Regional Load Balancers** - L7 та L4 балансувальники в кожному регіоні
- **Health Monitoring** - моніторинг стану сервісів та автоматичний failover
- **Multi-Region Deployment** - розгортання в Європі, Америці та Азії

**Компоненти архітектури:**
- **Global Traffic Manager** - маршрутизація на основі геолокації та затримки
- **L7 Load Balancer** - HTTP/HTTPS трафік для API та веб-сервісів
- **L4 Load Balancer** - TCP/UDP трафік для відео та стримінгу
- **Health Monitors** - перевірка доступності сервісів через HTTP/TCP/Ping

### 2. API Gateway with Private Services (request-response-sequence.puml)
**Архітектура з API Gateway та приватними сервісами через Cloudflare Tunnel**

Детальна схема обробки запитів через багаторівневу архітектуру:
- **Edge Layer** - Cloudflare Network з WAF, DDoS захистом та бот-фільтрами
- **API Gateway** - аутентифікація, rate limiting, кешування та агрегація
- **Private Network** - Cloudflare Tunnel для безпечного доступу до приватних сервісів
- **Zero Trust Security** - mTLS та безпечний доступ до внутрішніх сервісів

**Потік обробки запитів:**
1. **Edge Processing** - фільтрація та очищення трафіку
2. **Authentication** - перевірка токенів та застосування rate limits
3. **Cache Check** - перевірка кешу на рівні API Gateway
4. **Service Aggregation** - паралельні виклики до публічних та приватних сервісів
5. **Response Assembly** - агрегація та трансформація відповідей

## Ключові концепції

### Типи балансування навантаження
1. **L4 (Transport Layer)** - балансування на рівні TCP/UDP
2. **L7 (Application Layer)** - балансування на рівні HTTP/HTTPS
3. **Global Load Balancing** - маршрутизація між регіонами
4. **Local Load Balancing** - балансування в межах дата-центру

### Алгоритми балансування
- **Round Robin** - циклічне розподілення запитів
- **Least Connections** - маршрутизація до сервера з найменшою кількістю з'єднань
- **Weighted Round Robin** - розподілення з урахуванням ваги серверів
- **IP Hash** - прив'язка клієнта до конкретного сервера
- **Geographic Routing** - маршрутизація на основі геолокації

### Стратегії failover
- **Active-Passive** - один активний сервер, інші в режимі очікування
- **Active-Active** - всі сервери обробляють трафік
- **Health Checks** - регулярна перевірка доступності сервісів
- **Circuit Breaker** - автоматичне відключення несправних сервісів

## Архітектурні рішення

### Глобальна архітектура
- **Anycast DNS** - найближчий DNS сервер для клієнта
- **Geographic Distribution** - розміщення в різних регіонах
- **Edge Computing** - обробка на периферії мережі
- **CDN Integration** - кешування статичного контенту

### Безпека та приватність
- **Zero Trust Architecture** - перевірка кожного запиту
- **mTLS (Mutual TLS)** - взаємна аутентифікація
- **Private Tunnels** - безпечний доступ до внутрішніх сервісів
- **WAF (Web Application Firewall)** - захист від веб-атак

### Моніторинг та observability
- **Health Monitoring** - перевірка стану сервісів
- **Performance Metrics** - метрики продуктивності
- **Distributed Tracing** - відстеження запитів через систему
- **Alerting** - сповіщення про проблеми

### Оптимізація продуктивності
- **Connection Pooling** - перевикористання з'єднань
- **Caching Strategies** - багаторівневе кешування
- **Compression** - стиснення трафіку
- **HTTP/2 Support** - підтримка сучасних протоколів

## Практичні рекомендації

### Вибір стратегії балансування залежить від:
- **Traffic Patterns** - характер трафіку (HTTP, TCP, UDP)
- **Geographic Distribution** - розподілення користувачів
- **Performance Requirements** - вимоги до затримки та пропускної здатності
- **High Availability** - вимоги до доступності

### Моніторинг та метрики:
- **Response Time** - час відповіді сервісів
- **Throughput** - кількість запитів на секунду
- **Error Rate** - відсоток помилок
- **Availability** - відсоток доступності сервісу

### Типові проблеми та рішення:
- **Hot Spots** - дисбаланс навантаження на сервери
- **Cascading Failures** - поширення збоїв по системі
- **Session Affinity** - прив'язка сесій до серверів
- **Health Check Sensitivity** - налаштування чутливості перевірок
