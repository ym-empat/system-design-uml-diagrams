# Лекція 4: Кешування та Стратегії Кешування

У цій папці містяться UML діаграми, що демонструють різні стратегії кешування, їх переваги та недоліки, а також практичне застосування в реальних системах.

## Діаграми

### 1. Cache Aside Pattern (cache-aside-schema.uml)
**Найпоширеніша стратегія кешування**

Архітектура, де додаток самостійно керує кешем:
- **Read Path:** спочатку перевіряє кеш, при промаху завантажує з БД
- **Write Path:** записує в БД, потім інвалідує кеш
- **Контроль:** повний контроль над кешем з боку додатку

**Переваги:** простота, гнучкість, контроль над консистентністю
**Недоліки:** додаткова складність в коді, можливі race conditions

### 2. Read Through Pattern (read-through-schema.uml)
**Автоматичне завантаження при промаху**

Кеш автоматично завантажує дані з БД при промаху:
- **Transparent Loading:** кеш сам завантажує дані з БД
- **Simplified App Logic:** додаток просто читає з кешу
- **Consistent Interface:** єдиний інтерфейс для читання

**Переваги:** спрощений код додатку, автоматичне завантаження
**Недоліки:** складніша реалізація кешу, менше контролю

### 3. Write Through Pattern (write-through-schema.uml)
**Синхронний запис в кеш та БД**

Кожен запис одночасно йде в кеш та БД:
- **Synchronous Write:** запис в обидва місця одночасно
- **Data Consistency:** кеш завжди синхронізований з БД
- **Write Latency:** вища затримка через подвійний запис

**Переваги:** гарантована консистентність, простота логіки
**Недоліки:** вища затримка запису, більше навантаження на БД

### 4. Write Around Pattern (write-around-schema.uml)
**Запис тільки в БД, кеш оновлюється при читанні**

Стратегія, де записи йдуть тільки в БД:
- **Write to DB Only:** записи не оновлюють кеш
- **Cache on Read:** кеш оновлюється тільки при читанні
- **Write Performance:** швидкий запис без оновлення кешу

**Переваги:** швидкий запис, менше навантаження на кеш
**Недоліки:** застарілі дані в кеші до наступного читання

### 5. Write Back Pattern (write-back-schema.uml)
**Асинхронний запис в БД через фонові процеси**

Кеш приймає записи швидко, БД оновлюється асинхронно:
- **Fast Write:** запис в кеш завершується миттєво
- **Background Flush:** БД оновлюється фоновим процесом
- **Risk of Data Loss:** можлива втрата даних при збої кешу

**Переваги:** найшвидший запис, висока пропускна здатність
**Недоліки:** ризик втрати даних, складність реалізації

### 6. Online Store Case Study (online-store-case.uml)
**Практичний приклад багаторівневого кешування**

Реальний сценарій інтернет-магазину з різними рівнями кешування:
- **CDN Layer:** статичні ресурси (CSS, JS, зображення)
- **Application Cache:** динамічні дані (Redis)
- **TTL Strategy:** різні TTL для різних типів даних
- **Cache Warming:** прогрівання кешу при першому відвідуванні

**Рівні кешування:**
1. **Browser Cache** - локальне кешування в браузері
2. **CDN Edge** - глобальне кешування статики
3. **Application Cache** - кешування API відповідей
4. **Database** - персистентне зберігання

## Ключові концепції

### Типи кешування
1. **In-Memory Cache** - Redis, Memcached
2. **Application Cache** - кеш на рівні додатку
3. **CDN Cache** - кешування статичних ресурсів
4. **Database Cache** - кеш на рівні БД

### Стратегії інвалідації
- **TTL (Time To Live)** - автоматичне застарівання
- **Manual Invalidation** - ручна інвалідація
- **Event-Based** - інвалідація по подіях
- **Write-Through** - інвалідація при записі

### Метрики кешування
- **Hit Rate** - відсоток успішних звернень до кешу
- **Miss Rate** - відсоток промахів кешу
- **Latency** - затримка доступу до кешу
- **Memory Usage** - використання пам'яті кешем

## Архітектурні рішення

### Вибір стратегії кешування залежить від:
- **Read/Write Ratio** - співвідношення читання до запису
- **Data Freshness Requirements** - вимоги до свіжості даних
- **Performance Requirements** - вимоги до продуктивності
- **Consistency Requirements** - вимоги до консистентності

### Оптимізація кешування:
- **Cache Warming** - попереднє завантаження популярних даних
- **Cache Partitioning** - розподіл кешу по ключах
- **Cache Compression** - стиснення даних в кеші
- **Cache Monitoring** - моніторинг ефективності кешу

### Типові проблеми:
- **Cache Stampede** - одночасні запити при промаху
- **Cache Penetration** - запити неіснуючих даних
- **Cache Avalanche** - масове застарівання кешу
- **Hot Key Problem** - дисбаланс навантаження на ключі
